!function(){var t=this.hf||{};t.version="0.0.1";var e=function(){"use strict";var t={DAL:"Dallas Cowboys",NYG:"New York Giants",DEN:"Denver Broncos",PIT:"Pittsburgh Steelers",ARI:"Arizona Cardinals",SEA:"Seattle Seahawks",WAS:"Washington Redskins",NO:"New Orleans Saints",MIN:"Minnesota Vikings",JAC:"Jacksonville Jaguars",HOU:"Houston Texans",MIA:"Miami Dolphins",PHI:"Philadelphia Eagles",CLE:"Cleveland Browns",CHI:"Chicago Bears",IND:"Indianapolis Colts",ATL:"Atlanta Falcons",KC:"Kansas City Chiefs",NE:"New England Patriots",TEN:"Tennessee Titans",NYJ:"New York Jets",BUF:"Buffalo Bills",SF:"San Francisco 49ers",GB:"Green Bay Packers",TB:"Tampa Bay Buccaneers",CAR:"Carolina Panthers",DET:"Detroit Lions",LAR:"Los Angeles Rams",LAC:"Los Angeles Chargers",OAK:"Oakland Raiders",BAL:"Baltimore Ravens",CIN:"Cincinnati Bengals",NFCE:"NFC East",NFCN:"NFC North",NFCS:"NFC South",NFCW:"NFC West",AFCE:"AFC East",AFCN:"AFC North",AFCS:"AFC South",AFCW:"AFC West",AFC:"American Football Conference",NFC:"National Football Conference"},e={DAL:"NFCE",NYG:"NFCE",DEN:"AFCW",PIT:"AFCN",ARI:"NFCW",SEA:"NFCW",WAS:"NFCE",NO:"NFCS",MIN:"NFCN",JAC:"AFCS",HOU:"AFCS",MIA:"AFCE",PHI:"NFCE",CLE:"AFCN",CHI:"NFCN",IND:"AFCS",ATL:"NFCS",KC:"AFCW",NE:"AFCE",TEN:"AFCS",NYJ:"AFCE",BUF:"AFCE",SF:"NFCW",GB:"NFCN",TB:"NFCS",CAR:"NFCS",DET:"NFCN",LAR:"NFCW",LAC:"AFCW",OAK:"AFCW",BAL:"AFCN",CIN:"AFCN"},n={DAL:"NFC",NYG:"NFC",DEN:"AFC",PIT:"AFC",ARI:"NFC",SEA:"NFC",WAS:"NFC",NO:"NFC",MIN:"NFC",JAC:"AFC",HOU:"AFC",MIA:"AFC",PHI:"NFC",CLE:"AFC",CHI:"NFC",IND:"AFC",ATL:"NFC",KC:"AFC",NE:"AFC",TEN:"AFC",NYJ:"AFC",BUF:"AFC",SF:"NFC",GB:"NFC",TB:"NFC",CAR:"NFC",DET:"NFC",LAR:"NFC",LAC:"AFC",OAK:"AFC",BAL:"AFC",CIN:"AFC"},a={AFCE:["BUF","MIA","NE","NYJ"],AFCN:["BAL","CIN","CLE","PIT"],AFCS:["HOU","IND","JAC","TEN"],AFCW:["DEN","KC","LAC","OAK"],NFCE:["DAL","NYG","PHI","WAS"],NFCN:["CHI","DET","GB","MIN"],NFCS:["ATL","CAR","NO","TB"],NFCW:["ARI","LAR","SEA","SF"]},r={AFC:["NE","MIA","NYJ","BUF","BAL","PIT","CIN","CLE","HOU","IND","TEN","JAC","DEN","LAC","OAK","KC"],NFC:["WAS","DAL","NYG","PHI","GB","MIN","CHI","DET","ATL","CAR","NO","TB","SF","SEA","LAR","ARI"]},s={ARI:["870619","000000","FFFFFF"],ATL:["BD0D18","000000","FFFFFF","DCE0E5"],BAL:["280353","000000","D0B240","FFFFFF"],BUF:["00338D","C60C30","FFFFFF"],CAR:["000000","0088CE","A5ACAF","FFFFFF"],CHI:["03202F","DD4814","FFFFFF"],CIN:["000000","FB4F14","FFFFFF"],CLE:["26201E","E34912","FFFFFF"],DAL:["002244","8C8B8A","FFFFFF"],DEN:["FB4F14","002244","FFFFFF"],DET:["006DB0","C5C7CF","000000","FFFFFF"],GB:["213D30","FFCC00"],HOU:["02253A","B31B34","FFFFFF"],IND:["003B7B","FFFFFF"],JAC:["000000","D0B239","007198","FFFFFF"],KC:["B20032","F2C800"],MIA:["008d97","015679","FFFFFF","F5811F"],MIN:["4F2682","FFC52F","FFFFFF"],NE:["0D254C","D6D6D6","C80815","FFFFFF"],NO:["D2B887","000000","FFFFFF"],NYG:["192F6B","CA001A","FFFFFF","808080"],NYJ:["0C371D","FFFFFF"],OAK:["C4C8CB","000000","FFFFFF"],PHI:["003B48","000000","708090","C0C0C0","FFFFFF"],PIT:["000000","F2C800","FFFFFF"],LAC:["08214A","EEC607","5B92E5","FFFFFF"],SF:["AF1E2C","E6BE8A","000000"],SEA:["06192E","4EAE47","ACB6BC","FFFFFF"],LAR:["13264B","C9AF74","FFFFFF"],TB:["D60A0B","89765F","000000","FFFFFF","FF7A00"],TEN:["648FCC","000080","FF0000","C0C0C0"],WAS:["773141","FFB612","FFFFFF"]};this.teamToDivision=function(t){if(e.hasOwnProperty(t))return e[t];throw new Error("No entry found for team "+t+" in division table")},this.teamToConference=function(t){if(n.hasOwnProperty(t))return n[t];throw new Error("No entry found for team "+t+" in conference table")},this.teamsOfDivision=function(t){if(a.hasOwnProperty(t))return a[t];throw new Error("No teams found in division "+t)},this.teamsOfConference=function(t){if(r.hasOwnProperty(t))return r[t];throw new Error("No teams found in conference "+t)},this.shortToLong=function(e){if(t.hasOwnProperty(e))return t[e];throw new Error("No entry for short name "+e+" found")},this.teamColor=function(t,e){if(s.hasOwnProperty(t)){var n=s[t];return e=e<0?0:e>=n.length?n.length-1:e,n[e]}throw new Error("No color defined for "+t+".")},this.teamsAsObject=function(){return t},this.biggerIsBetter=function(t,e){if("r"===e||"h"===e)return!0;var n=!0;return"t"===e&&"u"!==t&&(n=!1),"d"===t?!n:n},this.statName=function(t,e){var n="Unknown";return"w"==t?n="Win Rate":"p"==t?n="Points":"y"==t?n="Yards":"r"==t?n="o"==e?"Offense [%]":"d"==e?"Defense [%]":"Net [%]":"h"==t?n="Rating [%]":"t"==t&&(n="Turnovers"),"u"==e&&(n+=" Differential"),n}},n=null;t.meta=t.meta||function(){"use strict";return null===n&&(n=new e),n}(),t.stats=t.stats||{};var a=function(e){if(!(this instanceof a))return new a(e);this.teamfilter=function(n){return t.meta.teamToDivision(n)===e||t.meta.teamToConference(n)===e}};t.stats.Filter=a,t.stats=t.stats||{};var r=function(e){if(!(this instanceof r))return new r(e);var n=function(t){return t},a=e,s=n;this.aggregate=function(){return"divisions"==a?(s=t.meta.teamsOfDivision,{NFCN:"NFCN",NFCW:"NFCW",NFCS:"NFCS",NFCE:"NFCE",AFCN:"AFCN",AFCW:"AFCW",AFCS:"AFCS",AFCE:"AFCE"}):"conferences"==a?(s=t.meta.teamsOfConference,{NFC:"NFC",AFC:"AFC"}):(s=n,t.meta.teamsAsObject)},this.teams=function(t){return s(t)}};t.stats.Aggregator=r,t.stats=t.stats||{};var i=function(e,n,a){if(!(this instanceof i))return new i(e,n,a);var r,s,o=function(t){return"h"==t?"home":"a"==t?"away":"s"==t?"SOS":"p"==t?"SOSPlayed":"overall"},F=e,u=n,f=a[0],c=a[1],C=a[2],l=a[3],d=t.stats.data["_"+F+(u<10?"0":"")+u];"s"!=f&&"p"!=f&&d&&(d=d.stats);var h,A=function(){if(h=[],d){var t=d[o(f)];s&&(t=s.aggregate());for(p in t)r&&!r.teamfilter(p)||h.push(p)}};A(),this.precision=function(){return"s"==f||"p"==f||"w"==l||"t"==l?2:"y"==l?0:1},this.addendum=function(){return"h"!=l&&"r"!=l||"s"==f||"p"==f?"":"%"},this.filter=function(e){return r=e?new t.stats.Filter(e):void 0,A(),this},this.isAggregate=function(){return!!s},this.hasFilter=function(){return!!r},this.aggregate=function(e){return s=e?new t.stats.Aggregator(e):void 0,A(),this},this.setOwnOpp=function(t){c=t},this.getOffDef=function(){return C},this.setOffDef=function(t){C=t},this.getStat=function(){return l},this.setStat=function(t){l=t},this.array=function(){return h},this.previousWeek=function(){if(!s&&!r){var t=F,e=u-1;return e<=0&&(t=F-1,e=21),new i(t,e,f+c+C+l)}},this.statName=function(){return t.meta.statName(l,C)},this.hasRanking=function(){return"p"!=f&&"s"!=f&&(("u"!=C||"p"==l)&&"y"!=l&&"t"!=l&&("w"==l||"p"==l||"y"==l||"t"==l||"r"==l||"h"==l))},this.teamStat=function(t,e){var n=l;return e&&this.hasRanking()&&(n="r"+l),this.stat(o(f),t,c,C,n)};var m=function(t,e,n,a,r){if("SOS"==t)return d[t][e];if("SOSPlayed"==t)return d[t][e];if("u"==a&&"rp"!=r&&"ry"!=r&&"rt"!=r){var s=d[t][e][n].o[r]-d[t][e][n].d[r];return"t"==r&&(s*=-1),s}return d[t][e][n][a][r]};this.stat=function(t,e,n,a,r){if(d)return s?s.teams(e).map(function(e){return m(t,e,n,a,r)}).reduce(function(t,e){return t+e},0)/s.teams(e).length:m(t,e,n,a,r)},this.sort=function(t){var e=this;h.sort(function(n,a){var r=e.teamStat(n),s=e.teamStat(a);if(t){if(r>s)return 1;if(r<s)return-1}else{if(r>s)return-1;if(r<s)return 1}return 0})}};t.stats.Set=i,t.stats=t.stats||{};var o=function(e,n,a){if(!(this instanceof o))return new o(s,m,a);for(var r,i,F,u,f=function(t){return"h"==t?"home":"a"==t?"away":"s"==t?"SOS":"p"==t?"SOSPlayed":"overall"},c=a[0],C=a[1],l=a[2],d=a[3],h=t.stats.data,A=[],m=e.week,N=e.season;N<=n.season;N++){for(var g=N==n.season?n.week:21,v=m;v<=g;v++)A.push(function(t,e){return t+(e<10?"0":"")+e}(N,v));m=1}updateArrays=function(){i=[],r=[];var t=h["_"+A[0]].stats[f(c)];"s"!=c&&"p"!=c||(t=h["_"+A[0]][f(c)]),u&&(t=u.aggregate());for(p in t)F&&!F.teamfilter(p)||r.push(p);i=r.map(function(t){return{team:t,values:A.map(function(e){return{team:t,week:e}})}})},updateArrays(),this.statName=function(){return t.meta.statName(d,l)},this.filter=function(e){return F=e?new t.stats.Filter(e):void 0,updateArrays(),this},this.aggregate=function(e){return u=e?new t.stats.Aggregator(e):void 0,updateArrays(),this},this.setOwnOpp=function(t){C=t},this.setOffDef=function(t){l=t},this.setStat=function(t){d=t},this.teams=function(){return r},this.weeks=function(){return A},this.array=function(){return i};var S=function(t,e,n,a,r,s){var i=f(e);if("SOS"==i)return h["_"+t][i][n];if("SOSPlayed"==i)return h["_"+t][i][n];if("u"==r){var o=h["_"+t].stats[i][n][a].o[s]-h["_"+t].stats[i][n][a].d[s];return"t"==s&&(o*=-1),o}return h["_"+t].stats[i][n][a][r][s]};this.stat=function(t,e){if(h["_"+t])return u?u.teams(e).map(function(e){return S(t,c,e,C,l,d)}).reduce(function(t,e){return t+e},0)/u.teams(e).length:S(t,c,e,C,l,d)}};t.stats.Timeset=o,t.graphs=t.graphs||{};var F=function(e){if(!(this instanceof F))return new F(e);this.create=function(n,a){var r=n.array(),s=30*r.length,i=n.previousWeek(),o=!t.meta.biggerIsBetter(n.getOffDef(),n.getStat());n.sort(o);var F=d3.scale.linear();F=o?F.domain([n.teamStat(r[0]),n.teamStat(r[r.length-1])]):F.domain([n.teamStat(r[r.length-1]),n.teamStat(r[0])]),F=F.range([0,460]),el=d3.select(e),el.attr("class","bar").attr("viewBox","0 0 790 "+s).attr("preserveAspectRatio","none");!function(){var e=el.selectAll("g").data(r,function(t){return t}),s=e.enter();e.exit();s.append("g");var o=e.attr("class",function(t){return t}).attr("transform",function(t,e){return"translate(0,"+30*e+")"});o.append("rect").attr("width",function(t){return F(n.teamStat(t))+300}).attr("height",28),o.append("text").attr("x",5).attr("y",15).attr("dy",".27em").text(function(e,n){var a=n+1,r=i?i.teamStat(e,!0):i,s=a+". ";if(r&&i.hasRanking()){var o=r-a;s+="("+(0==o?"-":o>0?"+"+o:o)+") "}return s+t.meta.shortToLong(e)}),o.append("text").attr("x",function(t){return F(n.teamStat(t))+300-5}).attr("y",15).attr("dy",".27em").attr("text-anchor","end").text(function(t,e){var a=""+n.teamStat(t).toFixed(n.precision());return"["+(a+=n.addendum())+"]"}),n.isAggregate()||o.append("svg:image").attr("x",function(t){return F(n.teamStat(t))+300+2}).attr("height",28).attr("width",28).attr("xlink:href",function(t){return a+"img/"+t+".svg"})}()}};t.graphs.Bar=F,t.graphs=t.graphs||{};var u=function(e,n){if(!(this instanceof u))return new u(e);var a=function(t,e,n,a){return{type:t,ownopp:e,offdef:n,stat:a}},r=[a("rank","s","o","w"),a("team","s","o","w"),a(n,"s","o","h"),a(n,"s","o","r"),a(n,"s","d","r"),a(n,"s","o","w"),a(n,"s","u","p"),a(n,"s","u","t"),a(n,"s","u","y"),a(n,"s","o","p"),a(n,"s","o","t"),a(n,"s","o","y"),a(n,"s","d","p"),a(n,"s","d","t"),a(n,"s","d","y"),a(n,"o","o","h"),a(n,"o","o","r"),a(n,"o","d","r"),a(n,"o","o","w")];this.create=function(n,a){var s=n.array();n.sort(!1),el=d3.select(e),el.attr("class","table");var i=el.append("thead"),o=el.append("tbody"),F=i.append("tr"),u=function(t,e,n){F.append("th").attr("colspan",n).attr("scope",e).text(t)};F=i.append("tr"),u("","colspan","2"),u("Ratings","colspan","4"),u("Net","colspan","3"),u("Offense","colspan","3"),u("Defense","colspan","3"),u("Strenght of Schedule","colspan","4"),F=i.append("tr"),F.selectAll("th").data(r).enter().append("th").attr("scope","col").text(function(t){return"team"==t.type?"Team":"rank"==t.type?"Rank":"h"==t.stat?"Overall [%]":"r"==t.stat?"o"==t.offdef?"Offense [%]":"Defense [%]":"w"==t.stat?"Winrate":"t"==t.stat?"TO":"p"==t.stat?"Pts":"Yds"}).on("click",function(e){"team"!=e.type&&"rank"!=e.type&&(F.sort(function(a,r){var s=a,i=r;return t.meta.biggerIsBetter(e.offdef,e.stat)||(s=r,i=a),n.stat(e.type,i,e.ownopp,e.offdef,e.stat)-n.stat(e.type,s,e.ownopp,e.offdef,e.stat)}),f())}),F=o.selectAll("tr").data(s,function(t){return t}),F.enter().append("tr").each(function(t,e){d3.select(this).selectAll("td").data(r).enter().append("td")});var f=function(){F.each(function(t,e){d3.select(this).attr("class",function(t){return evenodd="odd ",e%2==0&&(evenodd="even "),evenodd+t}).selectAll("td").data(r).text(function(a){return"team"==a.type?t:"rank"==a.type?e+1+"":(retval=n.stat(a.type,t,a.ownopp,a.offdef,a.stat),"u"!=a.offdef||"p"!=a.stat&&"t"!=a.stat||(retval=retval.toFixed(1)),retval)})})};f()}};t.graphs.Table=u,t.graphs=t.graphs||{};var f=function(e){if(!(this instanceof f))return new f(e);this.create=function(n,a){var r={top:50,right:75,bottom:30,left:40},s=790-r.left-r.right,i=600-r.top-r.bottom,o=d3.scale.ordinal().domain(n.weeks()).rangePoints([0,s]),F=d3.scale.linear().range([i,0]);xAxis=d3.svg.axis().scale(o).orient("bottom"),yAxis=d3.svg.axis().scale(F).orient("left"),line=d3.svg.line().interpolate("cardinal").x(function(t){return o(t.week)}).y(function(t){return F(n.stat(t.week,t.team))}),el=d3.select(e).attr("class","timeline").attr("width",s+r.left+r.right).attr("height",i+r.left+r.right),el=el.append("g").attr("transform","translate("+r.left+","+r.top+")");var u=n.teams(),f=d3.min(u,function(t){return d3.min(n.weeks(),function(e){return n.stat(e,t)})}),c=d3.max(u,function(t){return d3.max(n.weeks(),function(e){return n.stat(e,t)})}),C=c-f,f=f-.05*C,c=c+.05*C;F.domain([f,c]),xAxis.tickFormat(function(t){return t.indexOf("01",4)>-1?t[0]+t[1]+t[2]+t[3]:o.domain().length<=22?t.indexOf("18",4)>-1?"WC":t.indexOf("19",4)>-1?"DR":t.indexOf("20",4)>-1?"CC":t.indexOf("21",4)>-1?"SB":t[4]+t[5]:t.indexOf("08",4)>-1?"8":t.indexOf("17",4)>-1?"17":void 0}),el.append("g").attr("class","xaxis").attr("transform","translate(0,"+i+")").call(xAxis).append("text").attr("x",o(o.domain()[o.domain().length-1])+15).attr("dy","0.5em").text("Weeks"),el.append("g").attr("class","yaxis").call(yAxis).append("text").attr("transform","rotate(-90)").attr("y",-10).attr("x",70).attr("dy","0.5em").style("text-anchor","end").text(n.statName());var l=el.selectAll(".team").data(n.array()).enter().append("g").attr("class","timelineentry");l.append("path").attr("team",function(t){return t.team}).attr("d",function(t){return line(t.values)}).attr("title",function(e){return t.meta.shortToLong(e.team)}),l.append("text").datum(function(t){return{team:t.team,value:t.values[t.values.length-1]}}).attr("transform",function(t){return"translate("+o(t.value.week)+","+F(n.stat(t.value.week,t.value.team))+")"}).attr("x",3).attr("dy",".35em").text(function(t){return t.team})}};t.graphs.Timeline=f,t.graphs=t.graphs||{};var c=function(e){if(!(this instanceof c))return new c(e);this.create=function(n,a,r,s){var i={top:50,right:75,bottom:30,left:40},o=790-i.left-i.right,F=500-i.top-i.bottom,u=d3.scale.linear().range([0,o]),f=d3.scale.linear().range([F,0]),c=d3.scale.linear().range([20,60]),C=d3.svg.axis().scale(u).orient("bottom"),l=d3.svg.axis().scale(f).orient("left").ticks(5),d=d3.select(e).attr("class","bubble").attr("width",o+i.left+i.right).attr("height",F+i.left+i.right);d=d.append("g").attr("transform","translate("+i.left+","+i.top+")");var h=n.array(),A=d3.min(h,function(t){return n.teamStat(t)}),p=d3.max(h,function(t){return n.teamStat(t)}),m=p-A,A=A-.05*m,p=p+.05*m;u.domain([A,p]),A=d3.min(h,function(t){return a.teamStat(t)}),p=d3.max(h,function(t){return a.teamStat(t)}),m=p-A,A-=.05*m,p+=.05*m,f.domain([A,p]),c.domain([d3.min(h,function(t){return r?r.teamStat(t):20}),d3.max(h,function(t){return r?r.teamStat(t):60})]),d.append("g").attr("class","xaxis").attr("transform","translate(0,"+F+")").call(C).append("text").attr("x",u(u.domain()[1])+10).attr("dy","0.5em").text(n.statName()),d.append("g").attr("class","yaxis").call(l).append("text").attr("transform","rotate(-90)").attr("y",-10).attr("x",50).attr("dy","0.5em").style("text-anchor","end").text(a.statName()),d.selectAll(".team").data(h).enter().append("g").append("svg:image").attr("team",function(t){return t}).attr("x",function(t){return u(n.teamStat(t))}).attr("y",function(t){return f(a.teamStat(t))}).attr("height",function(t){return c(r?r.teamStat(t):60)}).attr("width",function(t){return c(r?r.teamStat(t):60)}).attr("xlink:href",function(t){return s+"img/"+t+".svg"}).attr("title",function(e){return t.meta.shortToLong(e)})}};t.graphs.Bubble=c,this.hf=t}();